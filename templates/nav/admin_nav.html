{% load debate_tags %}

<div class="nav-sidebar">
  <div class="overflow-scroll-wrapper">

    {% if all_tournaments.count > 1 %}
    <ul class="nav nav-stacked" role="tablist">
      <li role="presentation" class="dropdown">
        <a id="tournament_select" href="#" class="dropdown-toggle {% if overview_nav %}active{% endif %}" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
          <h5>
            {{ tournament }}<span class="caret pull-right"></span>
          </h5>
        </a>
        <ul id="tournament_select_menu" class="dropdown-menu" aria-labelledby="tournament_select">
          {% for t in all_tournaments %}
            {% if tournament != t %}
              <li>
                <a class="small" href="{{ tournament.get_absolute_url  }}">
                  {{ t }}
                </a>
              </li>
            {% endif %}
          {% endfor %}
          <li role="separator" class="divider"></li>
          <li>
            <a class="small" href="#">Overview</a>
          </li>
        </ul>
      </li>
    </ul>
    {% else %}
      <ul class="nav nav-stacked" role="tablist">
        <li role="presentation" class="">
          <a id="tournament_select" class="{% if overview_nav %}active{% endif %}" href="{{ tournament.get_absolute_url }}">
            <h4>
              <span class="emoji">üí©</span>{{ tournament }}
            </h4>
          </a>
        </li>
      </ul>
    {% endif %}

    <ul class="nav nav-stacked nav-accordion" id="accordion" role="tablist" aria-multiselectable="true">

      {% if pref.side_allocations_enabled == 'preallocated' %}
        <li class="standalone">
          <a href="{% tournament_url side_allocations %}" class="{% if sides_nav %}active{% endif %}">
            <span class="glyphicon glyphicon-resize-horizontal"></span> Sides
          </a>
        </li>
      {% endif %}
      {% if pref.enable_divisions %}
        <li class="standalone">
          <a href="{% tournament_url division_allocations %}" class="{% if divisions_nav %}active {% endif %}">
            <span class="glyphicon glyphicon-th-list"></span> Divisions
          </a>
        </li>
      {% endif %}
      <li class="standalone">
        <a href="{% tournament_url feedback_overview %}" class="{% if feedback_nav %} active {% endif %}">
          <span class="glyphicon glyphicon-comment"></span> Feedback
        </a>
      </li>
      <li class="standalone">
        <a href="{% round_url standings_index current_round %}" class="{% if standings_nav %} active {% endif %}">
          <span class="glyphicon glyphicon-stats"></span> Standings
        </a>
      </li>
      <li class="standalone">
        <a href="{% tournament_url breaking_index %}" class="{% if break_nav %} active {% endif %}">
          <span class="glyphicon glyphicon-gift"></span> Breaks
        </a>
      </li>

      <li class="panel">
        <div class="progress-line standard-line"></div>
        <div class="" role="tab" id="headingOne">
          <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
            <span class="circle-icon icon-container">
              <span class="glyphicon glyphicon-briefcase"></span>
            </span>
            Setup<span class="caret pull-right"></span>
          </a>
        </div>
        <div id="collapseOne" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
          <ul class="nav nav-pills nav-stacked">
            <li>
              <a href="{% tournament_url tournament_config_index %}">
                <span class="glyphicon glyphicon-cog"></span>Configuration
              </a>
            </li>
            <li>
              <a class="" href="{% tournament_url data_index %}">
                <span class="glyphicon glyphicon-download"></span>Import Data
              </a>
            </li>
            <li>
              <a class="" href="/admin/">
                <span class="glyphicon glyphicon-edit">Ô∏è</span>Edit Data
              </a>
            </li>
          </ul>
        </div>
      </li>

      {% for r in tournament.round_set.all %}

        <li class="panel">
          {% if not forloop.last %}<div class="progress-line standard-line"></div>{% endif %}
          <div class="" role="tab" id="rh{{ r.id }}">
            <a class="{% if r.seq == round.seq %}active{% else %}collapsed{% endif %}" role="button" data-toggle="collapse" data-parent="#accordion" href="#rp{{ r.id }}" aria-expanded="{% if r.seq == round.seq %}true{% else %}false{% endif %}" aria-controls="rp{{ r.id }}">
              <span class="circle-icon {% if r == current_round %}btn-info {% elif r.seq > current_round.seq %}btn-inactive {% elif r.seq < current_round.seq %}btn-success{% endif %}">
              <span class="emoji"></span></span>{{ r.abbreviation }} <span class="caret pull-right"></span>
            </a>
          </div>
          <div id="rp{{ r.id }}" class="panel-collapse collapse {% if r.seq == round.seq %}in{% endif %}" role="tabpanel" aria-labelledby="rh{{ r.id }}">
            <ul class="nav nav-stacked">
              <div class="progress-line standard-line"></div>
              <li>
                <div class="progress-line standard-line"></div>
                <a href="{% round_url availability_index r %}" {% if availability_nav and round == r %}class="active"{% endif %}>
                  <span class="circle-icon small-circle
                  {% if r.seq < current_round.seq %} btn-success
                  {% elif r == current_round and r.draw_status == r.STATUS_NONE %} btn-info
                  {% elif r.draw_status == r.STATUS_DRAFT %} btn-success
                  {% elif r.draw_status == r.STATUS_CONFIRMED %} btn-success
                  {% elif r.draw_status == r.STATUS_RELEASED %} btn-success
                  {% else %} btn-inactive{% endif %}
                  ">
                  <span class="emoji"></span></span>Checkins
                </a>
              </li>
              <li>
                <div class="progress-line standard-line"></div>
                <a href="{% round_url draw r %}" {% if draw_nav and round == r %}class="active"{% endif %}>
                  <span class="circle-icon small-circle
                  {% if r.seq < current_round.seq %} btn-success
                  {% elif r.draw_status == r.STATUS_NONE %} btn-inactive
                  {% elif r.draw_status == r.STATUS_CONFIRMED %} btn-success
                  {% elif r.draw_status == r.STATUS_RELEASED %} btn-success
                  {% else %} btn-info{% endif %}
                  ">
                  <span class="emoji"></span></span>Draw
                </a>
              </li>
              <li>
                <div class="progress-line standard-line"></div>
                <a href="{% round_url results r %}" {% if ballots_nav and round == r %}class="active"{% endif %}>
                  <span class="circle-icon small-circle
                  {% if r.seq < current_round.seq %} btn-success
                  {% elif r.draw_status == r.STATUS_CONFIRMED %} btn-info
                  {% elif r.draw_status == r.STATUS_RELEASED %} btn-info
                  {% else %} btn-inactive{% endif %}
                  ">
                  <span class="emoji"></span></span>Results
                </a>
              </li>
            </ul>
          </div>
        </li>

      {% endfor %}

    </ul>

  </div>
</div><!-- /.main-col -->
