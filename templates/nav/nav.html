{% load debate_tags %}
{% load cache %}

<header class="overall-header">

<nav class="navbar navbar-default navbar-transparent navbar-static-top" role="navigation">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      {% cache 600 headerleft request.user %}
        {% if all_tournaments.count > 1 %}
          <ul id="nav_brand" class="nav navbar-nav navbar-left">
            <li class="dropdown">
              <a href="#" class="navbar-brand dash-nav dropdown-toggle" data-toggle="dropdown">{{ tournament }}<b class="caret"></b></a>
              <ul class="dropdown-menu">
                {% for tournament in all_tournaments %}
                  {% if user.is_authenticated %}
                    <li><a class="" href="{{ tournament.get_absolute_url  }}">{{ tournament }}</a></li>
                  {% else %}
                    <li><a class="" href="{{ tournament.get_public_url  }}">{{ tournament }}</a></li>
                  {% endif %}
                {% endfor %}
                {% if all_tournaments.0.pref.public_divisions > 0 %}
                  <li><a href="{{ all_tournaments.0.get_all_divisions_url }}">All Tournament's Teams</a></li>
                {% endif %}
              </ul>
            </li>
          </ul>
        {% else %}
          {% if user.is_authenticated %}
            <a class="navbar-brand" href="{{ tournament.get_absolute_url  }}">{{ tournament }}</a>
          {% else %}
            <a class="navbar-brand" href="{{ tournament.get_public_url  }}">{{ tournament }}</a>
          {% endif %}
        {% endif %}
      {% endcache %}

      <ul class="nav navbar-nav nav-pills">
        {% for r in tournament.round_set.all %}
          <li id="round-{{ r.seq }}" class="{% if r.seq == current_round.seq %}active{% endif %} round-nav">
            <a href="#" class="dropdown-toggle round-nav {% if r.seq == current_round.seq %}current-round{% endif %}">
              <span class="{% if r.draw_status == r.STATUS_RELEASED %}text-success{% elif r.draw_status == r.STATUS_CONFIRMED %}text-primary{% elif r.draw_status == r.STATUS_DRAFT %}text-warning{% endif %}">
                {{ r.abbreviation }}
              </span>
            </a>
          </li>
        {% endfor %}
      </ul>

      <ul class="nav navbar-nav navbar-right ">

        {% if user.is_authenticated %}
          {% if user.is_superuser %}
            {% if tournament %}
              <li><a href="{% tournament_url tournament_config_index %}">Config</a></li>
              <li><a href="{% tournament_url data_index %}">Data Import</a></li>
              <li><a href="/admin/">Data Admin</a></li>
            {% endif %}
          {% endif %}
          <li><a href="/accounts/logout/" title="Log out of {{ user }}">Logout of {{ user }}</a></li>
        {% else %}
          <li><a href="/accounts/login/" title="Log in">Log in</a></li>
        {% endif %}

      </ul>


    </div>
  </div>
</nav>

<nav>
  <div class="container-fluid">
    {% if 'admin' in request.path %}
      {% if user.is_superuser %}
        {% include "nav/admin_nav.html" %}
      {% else %}
        {% include "nav/assistant_nav.html" %}
      {% endif %}
    {% else %}
      {% include "nav/public_nav.html" %}
    {% endif %}
  </div>
</nav>

</header>