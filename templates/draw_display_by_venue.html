{% extends "base.html" %}
{% load debate_tags %}
{% load static %}

{% block head-title %}
    Draw for {{ round.name }}
    {% if round.starts_at %}
        <small>debates start at {{ round.starts_at }}</small>
    {% endif %}
{% endblock %}
{% block page-title %}Draw for {{ round.name }}{% endblock %}
{% block body-class %}draw-public-display{% endblock %}

{% block header %}
    <div class="btn-group">
        <a class="btn btn-default" href="" id="scroll_draw1">Scroll Fast</a>
        <a class="btn btn-default" href="" id="scroll_draw2">Scroll <span class="hidden-xs">Medium</span></a>
        <a class="btn btn-default" href="" id="scroll_draw3">Scroll Slow</a>
    </div>
    <div id="statusBar" class="btn-group">
        <div class="btn btn-default">Hit ESC to stop scrolling</div>
    </div>
    <div class="btn-group">
        <a class="btn btn-default" href="" id="tiny_text">Tiny Text</a>
        <a class="btn btn-default" href="" id="small_text">Small Text</a>
        <a class="btn btn-default active" href="" id="medium_text">Medium Text</a>
        <a class="btn btn-default" href="" id="large_text">Large Text</a>
        <a class="btn btn-default" href="" id="huge_text">Huge Text</a>
    </div>
{% endblock %}

{% block content %}
    <table id="draw" class="h4 table table-bordered">
        <thead>
            <tr>
                {% if enable_divisions %}
                    <th><span class="glyphicon glyphicon-th-list" data-toggle="tooltip" title="" data-original-title="Division"></span></th>
                {% endif %}
                <th><span class="glyphicon glyphicon-map-marker" data-toggle="tooltip" title="Venue"></span></th>
                {% if enable_venue_times %}
                    <th><span class="glyphicon glyphicon-calendar" data-toggle="tooltip" title="Date"></span></th>
                    <th><span class="glyphicon glyphicon-time" data-toggle="tooltip" title="Time"></span></th>
                {% endif %}
                {% if show_emoji > 0 %}
                    <th class="hidden-xs th-emoji"><img src="{% static 'emoji/img/grey_question.png' %}" /></th>
                {% endif %}
                <th>Aff<span class="hidden-xs">irmative</span></th>
                {% if show_emoji > 0 %}
                    <th class="hidden-xs th-emoji"><img src="{% static 'emoji/img/grey_question.png' %}" /></th>
                {% endif %}
                <th>Neg<span class="hidden-xs">ative</span></th>
                {% if enable_division_motions %}
                    <th>Motion</th>
                {% endif %}
                {% if not enable_divisions %}
                    <th>Adj<span class="hidden-xs">udicator</span>s</th>
                {% endif %}
            </tr>
        </thead>
        <tbody>
        {% for debate in draw %}
            <tr class="{% if debate.aff_team.type == 'B' or debate.neg_team.type == 'B' or debate.result_status == 'P'%}active text-muted{% endif %}">
                {% if enable_divisions %}
                    <td>D{{ debate.division.name }}</td>
                {% endif %}
                {% if enable_venue_groups %}
                    <td>
                        <span title="{{ debate.division.venue_group.name }}" data-toggle="tooltip">{{ debate.division.venue_group.short_name }}</span>
                    </td>
                {% else %}
                    <td class="venue-name">{{ debate.venue_splitname }}</td>
                {% endif %}
                {% if enable_venue_times %}
                    {% if debate.aff_team.type == 'B' or debate.neg_team.type == 'B'%}
                        <td></td>
                        <td>
                            <span class="text-primary">Bye (No Debate)</span></td>
                        </td>
                    {% elif debate.result_status = "P" %}
                        <td></td>
                        <td>
                            <span class="text-primary">Postponed</span></td>
                        </td>
                    {% else %}
                        <td>
                            <span class="hidden">{{ debate.venue.time|date:"o m d" }}</span>
                            {{ debate.venue.time|date:"D jS F" }}
                        </td>
                        <td>
                            {{ debate.division.time_slot|time:'h:i A' }}
                        </td>
                    {% endif %}
                {% endif %}
                {% if show_emoji > 0 %}
                    <td class="team-emoji team-{{ debate.aff_team.id }} hidden-sm"></td>
                {% endif %}
                <td class="team-name">
                    {% if debate.aff_team.type != 'B' %}
                        <span title="<h5>{{ debate.aff_team.long_name }}</h5>{% if show_speakers_in_draw %}{{ debate.aff_team.speakers|join:'<br>' }}{% endif %}" data-toggle="tooltip">
                            {{ debate.aff_team.short_name }}
                        </span>
                        {% if show_speakers_in_draw %}
                            <span class="hidden">
                               {{ debate.aff_team.speakers|join:', ' }}
                            </span>
                        {% endif %}
                    {% endif %}
                </td>
                {% if show_emoji > 0 %}
                    <td class="team-emoji team-{{ debate.neg_team.id }} hidden-sm "></td>
                {% endif %}
                <td class="team-name">
                    {% if debate.neg_team.type != 'B'  %}
                        <span title="<h5>{{ debate.neg_team.long_name }}</h5>{% if show_speakers_in_draw %}{{ debate.neg_team.speakers|join:'<br>' }}{% endif %}" data-toggle="tooltip">
                            {{ debate.neg_team.short_name }}
                        </span>
                        {% if show_speakers_in_draw %}
                            <span class="hidden">
                               {{ debate.neg_team.speakers|join:', ' }}
                            </span>
                        {% endif %}
                    {% endif %}
                </td>
                {% if enable_division_motions %}
                    <td style="max-width: 10%">
                        {% for motion in debate.division_motion %}
                            <span>{{ motion.reference }}</span>
                            <small title="{{ motion.text }}" data-toggle="tooltip">(view motion)</small>
                        {% endfor %}
                    </td>
                {% endif %}
                {% if not enable_divisions %}
                    <td class="adj-names">
                        {% for type, adj in debate.adjudicators %}
                            {% if type == 'C' and debate.adjudicators.is_panel %}
                                <span class="adj-chair">{{ adj.name }} Ⓒ</span>
                            {% elif type == 'T' %}
                                <br><span class="adj-trainee">{{ adj.name }} Ⓣ</span>
                            {% else %}
                                {% if debate.adjudicators.panel %}<br>{% endif %}
                                <span class="adj-normal">{{ adj.name }}</span>
                            {% endif %}
                            {% if debate.adjudicators.panel %}</li>{% endif %}
                        {% endfor %}
                    </td>
                {% endif %}
            </tr>
        {% endfor %}
        </tbody>
    </table>

{% endblock content %}

{% block extra-js %}
    <script type="text/javascript">
        $(document).ready( function() {
            var table = $('#draw').dataTable({
                "aaSorting": [[ 0, "asc" ]],
            });
            new $.fn.dataTable.FixedHeader( table, {alwaysCloneTop: true});

        });
    </script>
    <script type="text/javascript" language="javascript" src="{% static 'js/emoji.js' %}"></script>
    <script type="text/javascript" language="javascript" src="{% static 'js/scroller.js' %}"></script>
{% endblock extra-js %}
