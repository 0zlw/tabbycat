{% extends "base.html" %}
{% load debate_tags %}
{% load staticfiles %}

{% block nav %}{% endblock %}

{% block body-class %}edit-adjs{% endblock %}
{% block head-title %}{% endblock %}
{% block page-title %}Edit Adjudicators for {{ round.abbreviation }}{% endblock %}
{% block page-header %}
  <div id="statusBar" class="btn-group">
    <div class="btn btn-default" href="#auto" id="auto_allocate">Auto Allocate</div>
    <div class="btn btn-default" data-loading-text="Saving..." href="" id="save">Save</div>
    <a class="btn btn-default" href="{% round_url draw %}">Quit</a>
  </div>
  <div id="statusBar" class="btn-group">
    <div class="btn btn-default" href="" id="toggle_venues">
      <span class="glyphicon glyphicon-eye-open"></span> Venues
    </div>
    <div class="btn btn-default" href="" id="toggle_wins">
      <span class="glyphicon glyphicon-eye-open"></span> Wins
    </div>
    <div class="btn btn-default" href="" id="toggle_gender">
      <span class="glyphicon glyphicon-eye-open"></span> Gender
    </div>
    <div class="btn btn-default" href="" id="toggle_region">
      <span class="glyphicon glyphicon-eye-open"></span> Region
    </div>
    <div class="btn btn-default" href="" id="toggle_language">
      <span class="glyphicon glyphicon-eye-open"></span> Language
    </div>
  </div>
  <div id="conflict_key" class="btn-group">
    <div class="btn btn-default btn-primary">Seen</div>
    <div class="btn btn-default btn-warning">Institution</div>
    <div class="btn btn-default btn-danger">Person</div>
    <div class="btn btn-default panel-incomplete">No Chair or Odd Panel</div>
    {% if show_unaccredited %}
    <div class="btn btn-default active is_unaccredited">Unaccredited</div>
    {% endif %}
  </div>
  <div id="gender_key" class="btn-group" style="display: none;">
    <div class="btn btn-default gender-display male">Male</div>
    <div class="btn btn-default gender-display female">Female</div>
  </div>
  <div id="region_key" class="btn-group" style="display: none;">
    {% for region in regions %}
      <div class="btn btn-default region-display region-{{ region.name|slugify }}">{{ region.name }}</div>
    {% endfor %}
  </div>
  <div id="language_key" class="btn-group" style="display: none;">
    <div class="btn btn-default language-display esl">ESL</div>
    <div class="btn btn-default language-display efl">EFL</div>
  </div>
{% endblock %}

{% block header %}{% endblock %}

{% block content %}

<div class="row">

  <div id="main" class="col-xs-10">

    <div id="alerts-holder"></div>
    <table id="allocationsTable" class=" table" cellpadding="0" cellspacing="0">
      <thead>
        <tr>
          <th><span class="glyphicon glyphicon-sort" data-toggle="tooltip" title="Bracket"></span></th>
          <th><span class="glyphicon glyphicon-fire" data-toggle="tooltip" title="Importance"></span></th>
          <th><span class="glyphicon glyphicon-map-marker" data-toggle="tooltip" title="Venue"></span></th>
          <th><span data-toggle="tooltip" title="Aff wins">AW</span></th>
          <th><span class="glyphicon glyphicon-off " data-toggle="tooltip" title="Aff's % of Previous Male Adjudicators"></span></th>
          <th>Aff<span class="hidden-xs">irmative</span></th>
          <th><span data-toggle="tooltip" title="Neg wins">NW</span></th>
          <th><span class="glyphicon glyphicon-off " data-toggle="tooltip" title="Neg's % of Previous Male Adjudicators"></span></th>
          <th>Neg<span class="hidden-xs">ative</span></th>
          <th>Chair</th>
          <th>Panel</th>
          <th>Trainee</th>
        </tr>
      </thead>
      <tbody>
      {% for debate in draw %}
      <tr id="debate_{{ debate.id }}">
        <td>
          {{ debate.bracket }}
        </td>
        <td class="btn-holder btn btn-default importance">
          {% if debate.importance == None %}
            n/a
          {% else %}
            {{ debate.importance }}
          {% endif %}
        </td>
        <td>
          {{ debate.venue }}
        </td>
        <td>
          {{ debate.aff_team.wins_count }}
        </td>
        <td class="{% if debate.aff_team.male_adj_percent >= debate.neg_team.male_adj_percent %}gender-parity-{{ debate.gender_class }} gender-highlight{% endif %}">
          {{ debate.aff_team.male_adj_percent }}
        </td>
        <td id="team_{{ debate.aff_team.id }}" class="teaminfo {% team_status_classes debate.aff_team %}">
          <span class="team-speakers-hover" id="team_speakers_{{ debate.aff_team.id }}">
            {{ debate.aff_team.short_name }}
          </span>
        </td>
        <td>
          {{ debate.neg_team.wins_count }}
        </td>
        <td class="{% if debate.neg_team.male_adj_percent >= debate.aff_team.male_adj_percent %}gender-parity-{{ debate.gender_class }} gender-highlight{% endif %}">
          {{ debate.neg_team.male_adj_percent }}
        </td>
        <td id="team_{{ debate.neg_team.id }}" class="teaminfo {% team_status_classes debate.neg_team %}">
          <span class="team-speakers-hover" id="team_speakers_{{ debate.neg_team.id }}">
            {{ debate.neg_team.short_name }}
          </span>
        </td>
        <td id="chair_{{ debate.id }}" class="btn-holder adj-holder chair-holder">
        </td>
        <td id="panel_{{ debate.id }}" class="btn-holder adj-holder panel-holder">
        </td>
        <td id="trainees_{{ debate.id }}" class="btn-holder adj-holder trainee-holder">
        </td>
      </tr>
      {% endfor %}
      </tbody>
    </table>
  </div>

  <div id="scratch" class="col-xs-2 fixed-right">
    <table id="unusedAdjTable" class="table" cellpadding="0" cellspacing="0">
      <thead>
        <tr>
          <th>Unused Adjudicators <span class="glyphicon glyphicon-save pull-right" id="toggle_unused_layout" data-toggle="tooltip" title="Toggle right/bottom alignment"></span></th>
          <th><span class="glyphicon glyphicon-sort"></span></th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <div id="helper_holder"></div>

</div>


<div class="modal fade" id="adj-feedback" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
  <div class="modal-content">
    <div class="modal-header"><h3>Feedback for <span id="modal-adj-name"></span></h3></div>
    <div class="modal-body">
    <table id="modal-adj-table" class="table">
      <thead>
      <tr>
        <th><span class="glyphicon glyphicon-time" data-toggle="tooltip" title="Round"></span></th>
        <th><span class="glyphicon glyphicon-sort" data-toggle="tooltip" title="Bracket"></span></th>
        <th>Debate</th>
        <th>Source</th>
        <th>Score</th>
        <th>Comments</th>
        <th>Confirmed</th>
      </tr>
      </thead>
      <tbody>
      </tbody>
    </table>
    </div>
  </div>
  </div>
</div>

<style style="text/css">
  {% if regions.0 %}
    .region-display.region-{{ regions.0.name|slugify }} {
      background: #B1E001;
      color: #fff;
    }
  {% endif %}
  {% if regions.1 %}
    .region-display.region-{{ regions.1.name|slugify }} {
      background: #476C5E;
      color: #fff;
      span a { color: #fff; }
    }
  {% endif %}
  {% if regions.2 %}
    .region-display.region-{{ regions.2.name|slugify }} {
      background: #777;
      color: #fff;
      span a { color: #fff; }
    }
  {% endif %}
  {% if regions.3 %}
    .region-display.region-{{ regions.3.name|slugify }} {
      background: #FF2983;
      color: #fff;
      span a { color: #fff; }
    }
  {% endif %}
  {% if regions.4 %}
    .region-display.region-{{ regions.4.name|slugify }} {
      background: #6A268C;
      color: #fff;
      span a { color: #fff; }
    }
  {% endif %}
  {% if regions.5 %}
    .region-display.region-{{ regions.5.name|slugify }} {
      background: #00C0CF;
      color: #fff;
      span a { color: #fff; }
    }
  {% endif %}
  {% if regions.6 %}
    .region-display.region-{{ regions.6.name|slugify }} {
      background: #0051CF;
      color: #fff;
      span a { color: #fff; }
    }
  {% endif %}
  {% if regions.7 %}
    .region-display.region-{{ regions.7.name|slugify }} {
      background: black;
      color: #fff;
      span a { color: #fff; }
    }
  {% endif %}
  {% if regions.8 %}
    .region-display.region-{{ regions.8.name|slugify }} {
      background: black;
      color: #fff;
      span a { color: #fff; }
    }
  {% endif %}
</style>

{% endblock content %}

{% block footer %}{% endblock footer %}

{% block extra-js %}
<script type="text/javascript" language="javascript" src="{% static 'js/jquery-ui-1.10.4.custom.min.js' %}"></script>
<script type="text/javascript" language="javascript" src="{% static 'js/jquery.jeditable.js' %}"></script>
<script type="text/javascript" charset="utf-8">
$(document).ready( function() {
  {% include 'js/draw_adjs_edit_allocation.js' %}
  {% include 'js/draw_adjs_edit_flags.js' %}
});
</script>
{% endblock extra-js %}