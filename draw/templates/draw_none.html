{% extends "draw_rbase.html" %}
{% load debate_tags %}

{% block page-title %}No draw for {{ round.name }}{% endblock %}
{% block head-title %}No draw for {{ round.name }} currently exists{% endblock %}


{% block page-alerts %}

  {% if previous_unconfirmed != 0  %}
  <div class="alert alert-danger">
    Note: {{ previous_unconfirmed }} debates from <strong>{{ round.prev.name }} do not have a completed b
    allot</strong> â€” this may lead to a draw that fails or is incorrect <em>depending</em> on your draw rules.
  </div>
  {% endif %}
  {% if not active_teams.count|divisibleby:2  %}
  <div class="alert alert-danger">
    Note: there is an uneven number of teams checked in for this round.
  </div>
  {% endif %}
  {% if active_teams.count == 0 or active_teams.count < all_teams_count %}
  <div class="alert alert-warning">
    Note: not all teams ({{ active_teams.count }} / {{ all_teams_count }}) <a class="alert-link" href="{% round_url team_availability round %}">have been checked in</a> for this round.
  </div>
  {% elif active_teams.count == 0 %}
  <div class="alert alert-danger">
    The draw cannot be generated until some of the teams <a class="alert-link" href="{% round_url team_availability round %}">have been checked in</a> for this round.
  </div>
  {% endif %}
  {% if active_adjs == 0 %}
  <div class="alert alert-warning">
    Note: no adjudicators have been <a class="alert-link" href="{% round_url adjudicator_availability round %}">checked in</a>.
  </div>
  {% endif %}
  {% if active_venues_count < rooms or rooms == 0 %}
  <div class="alert alert-danger">
    The draw cannot be generated until there are more venues than team matchups. <a class="alert-link" href="{% round_url venue_availability round %}">Check in some more venues</a>.
  </div>
  {% endif %}

{% endblock %}

{% block content %}

  {% if active_venues_count < rooms or active_teams.count == 0%}
    <a class="btn btn-success" disabled="disabled" id="createDraw">Create draw for {{ active_teams.count }}/{{ all_teams_count }} teams</a>
  {% else %}
    <a class="btn btn-success" id="createDraw">Create draw for the following {{ active_teams.count }}/{{ all_teams_count }} teams</a>
  {% endif %}
  {% if active_teams.count < all_teams_count %}
    {% if active_venues_count > all_teams_count or active_venues_count == 0 %}
      <a class="btn btn-warning" disabled="disabled" id="createDrawWithAllTeams">Create draw for ALL teams</a>
    {% else %}
      <a class="btn btn-warning" id="createDrawWithAllTeams">Create draw for ALL teams</a>
    {% endif %}
  {% endif %}


  {% if active_teams.count < all_teams_count %}
    <form id="createFormWithAllTeams" action="{% round_url create_with_all %}" method="POST"></form>
  {% endif %}
  <form id="createForm" action="{% round_url create_draw %}" method="POST"></form>
  <ul>
    {% for team in active_teams %}
      <li>{{ team.short_name }} ({{ team.institution.code }})</li>
    {% endfor %}
  </ul>

{% endblock content %}

{% block extra-js %}
  <script type="text/javascript" charset="utf-8">

    $(document).ready( function() {
      $("#createDraw").click( function() {
        $("#createForm").submit();
        return false;
      } );
      $("#createDrawWithAllTeams").click( function() {
        $("#createFormWithAllTeams").submit();
        return false;
      } );
    } );

  </script>
{% endblock extra-js %}