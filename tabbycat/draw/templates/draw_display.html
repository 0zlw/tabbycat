{% extends "base.html" %}
{% load debate_tags %}

{% block head-title %}Draw Display for {{ round.name }}{% endblock %}
{% block page-title %}Draw Display for {{ round.name }}{% endblock %}

{% block page-subnav-sections %}
{% if user.is_superuser %}

    <a class="btn btn-outline-primary " href="{% roundurl 'draw' %}">
      <i data-feather="chevron-left"></i> Draw
    </a>

    {% if not pref.enable_debate_scheduling %}
      <a href="" class="btn {% if round.starts_at %}btn-danger{% else %}btn-primary{% endif %}" data-toggle="modal" data-target="#editStartTime">
        {% if round.starts_at %}
          Debates Start at {{ round.starts_at }}
        {% else %}
          Add Start Time
        {% endif %}
      </a>
    {% else %}
      <a href="{% roundurl 'draw-schedule-debates' %}" class="btn btn-outline-primary ">
        Schedule Debates
      </a>
    {% endif %}

    {% if round.draw_status == round.STATUS_CONFIRMED %}
      <form id="releaseForm" method="POST" action="{% roundurl 'draw-release' %}">
        {% csrf_token %}
        <button class="btn btn-primary " type="submit"
        data-toggle="tooltip" data-placement="bottom"
        title="Releasing a draw makes it available to the public-facing
        pages of this site. If your tournament is configured to show public
        draws, or to allow teams or adjudicators to submit feedback/ballots,
        you will need to release each round's draw before that can happen.">
          Release Draw to Public
        </button>
      </form>
    {% elif round.draw_status == round.STATUS_RELEASED %}
      <form id="unreleaseForm" method="POST" action="{% roundurl 'draw-unrelease' %}">
        {% csrf_token %}
        <button class="btn btn-danger " type="submit">
          Unrelease Draw to Public
        </button>
      </form>
    {% endif %}

{% endif %}
{% endblock %}

{% block page-subnav-actions %}
{% if user.is_superuser %}
  <a class="btn btn-outline-success " href="{% roundurl 'motions-edit' %}">
    Enter Motions <i data-feather="chevron-right"></i>
  </a>
{% endif %}
{% endblock %}

{% block page-alerts %}
{% if user.is_superuser %}

  {% if round.draw_status == round.STATUS_RELEASED and not pref.public_draw %}
    <div class="alert alert-warning">
      You have released the draw, but it will not show to the public unless
      'public view of draw' setting is enabled in
      <a class="alert-link" href="{% tournamenturl 'options-tournament-index' %}">
         this tournament's configuration</a>.
    </div>
  {% endif %}

{% endif %}
{% endblock %}

{% block content %}

<div class="row">
  <div class="col-md-12">

    <ul class="list-group">
      <li class="list-group-item">
        <span class="emoji">🏫</span>
        <a target="_blank"  href="{% roundurl 'draw-display-by-venue' round %}">
          Display Draw ordered by Venue</a>
        <span class="text-muted">(for the briefing room)</span>
        <span class="badge badge-default badge-pill"><span class="icon glyphicon-share"></span></span>
      </li>
      <li class="list-group-item">
        <span class="emoji">👭</span>
          <a target="_blank"  href="{% roundurl 'draw-display-by-team' round %}">
            Display Draw ordered by Team</a>
          <span class="text-muted">(for the briefing room)</span>
          <span class="badge badge-default badge-pill"><span class="icon glyphicon-share"></span></span>
      </li>
      <li class="list-group-item">
        <span class="emoji">📃</span>
        {% if round.motions_released %}
          <a target="_blank"  href="{% roundurl 'motions-display' round %}">
            Display Motions</a>
          <span class="text-muted">(for the briefing room)</span>
          <span class="badge badge-default badge-pill"><span class="icon glyphicon-share"></span></span>
        {% else %}
          <a target="_blank" class="disabled" href="{% roundurl 'motions-display' round %}">
            Display Motions</a>
          <span class="text-muted">(for the briefing room)</span>
          <span class="badge badge-default badge-pill"><span class="icon glyphicon-share"></span></span>
        {% endif %}
      </li>
    </ul>

    <ul class="list-group mt-3">
      <li class="list-group-item">
        <span class="emoji">💯</span>
        <a target="_blank" href="{% roundurl 'printing-scoresheets' round %}">
          View Ballot Forms</a>
        <span class="text-muted">(for printing)</span>
        <span class="badge badge-default badge-pill"><span class="icon glyphicon-share"></span></span>
      </li>
      <li class="list-group-item">
        <span class="emoji">🙅</span>
        <a target="_blank" href="{% roundurl 'printing-feedback' round %}">
          View Feedback Forms</a>
        <span class="text-muted">(for printing)</span>
        <span class="badge badge-default badge-pill"><span class="icon glyphicon-share"></span></span>
      </li>
      {% if pref.public_divisions %}
      <li class="list-group-item">
        <span class="emoji">📠</span>
        <a target="_blank" href="{% roundurl 'printing-master-sheets-list' round %}">
          View Division Sheets</a>
        <span class="text-muted">(for printing)</span>
        <span class="badge badge-default badge-pill"><span class="icon glyphicon-share"></span></span>
      </li>
      {% endif %}
    </ul>

  </div>
</div>


<div class="modal fade" id="editStartTime" tabindex="-1" role="dialog" aria-labelledby="editStartTime">
  <div class="modal-dialog modal-sm">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Change Start Time</h3>
      </div>
      <div class="modal-body">
        <form id="startTimeForm" method="POST" action="{% roundurl 'draw-start-time-set' %}" class="">
          <div class="form-group">
            <label>
              Start at
            </label>
            <div class="col-sm-6">
              <input class="form-control" placeholder="{{ round.starts_at|time:'H:i' }}" name="start_time" ></input>
            </div>
          </div>
          <div class="form-group">
            <label></label>
            <div class="col-sm-6">
              <button type="submit" value="Save" class="btn btn-success " data-loading-text="Saving...">Save</button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

{% endblock content %}
