{% extends "base.html" %}
{% load static %}
{% load debate_tags %}
{% load i18n %}

{% block page-title %}{% trans "Dashboard" %}{% endblock %}
{% block head-title %}<span class="emoji">‚è∞</span>{% trans "Overview" %}{% endblock %}

{% block sub-title %}
  {% blocktrans with round_name=round.name round_status=round.get_draw_status_display.lower %}{{ round_name }}'s status is {{ round_status }}{% endblocktrans %}
{% endblock %}

{% block content %}

  {% if blank %}

    <div class="card border-info text-info mb-3">
      <div class="card-body">
        <h4 class="card-title">Welcome to your new tournament!</h4>
        <p class="card-text">
          The next step is to import your initial tournament data: the institutions, teams, adjudicators
          and venues that are in your tournament. There are a number of ways to do
          this. For small-to-medium tournaments, the simple importer is your best bet.
          {# Translators: The documentation where the link goes to is in English; translations should mention this with "(in English)" after the link. #}
          {% blocktrans trimmed %}For more information, please consult our
          <a href="https://tabbycat.readthedocs.io/en/{{ readthedocs_version }}/use/importing-data.html" class="alert-link" target="_blank">
            documentation on importing initial data</a>.
            {% endblocktrans %}
        </p>
      </div>
    </div>

    {% tournamenturl 'importer-simple-index' as url %}
    {% include "components/item-action.html" with alone=True text="Use the simple importer to add your initial data." success=True %}

  {% elif round.get_draw_status_display.lower == 'none' %}

    {% roundurl 'availability-index' round as url %}
    {% include "components/item-action.html" with alone=True text="Go to the checkins area to begin creating a draw." success=True %}

  {% elif round.get_draw_status_display.lower == 'confirmed' %}

    {% roundurl 'draw' round as url %}
    {% include "components/item-action.html" with alone=True text="Go to the draw area to allocate adjudicators." success=True %}

  {% elif round.get_draw_status_display.lower == 'released' %}

    {% roundurl 'draw' round as url %}
    {% include "components/item-action.html" with alone=True text="Go to the results area to begin entering ballots." success=True %}

  {% endif %}

  <div id="vueMount">
    <tournament-overview-container :actions-url="updateActionsURL"
                                   :results-url="updateResultsURL"
                                   :ballots-url="updateBallotsURL"
                                   :round-status="roundStatus">
    </tournament-overview-container>

  </div>

{% endblock content %}

{% block js %}
  <script>
    window.vueData = {
      updateBallotsURL: '{% tournamenturl 'results-ballots-graph-data' %}',
      updateActionsURL: '{% tournamenturl 'actionlog-latest-json' %}',
      updateResultsURL: '{% tournamenturl 'results-latest-json' %}',
      roundStatus: '{{ round_status }}'
    }
  </script>
  {{ block.super }}
{% endblock %}
