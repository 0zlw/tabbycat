{% load i18n %}

<div class="col-sm-12">

{% if motion.ndebates > 0 %}

  {% if round.stage != round.STAGE_ELIMINATION %}
    <div class="row mb-3">
      <div class="col-md-12">
        <div class="progress">
          {% for side, average, width in motion.averages %}
            {% if average > 0 %}
              <div class="progress-bar progress-bar-{{ side }}"
                   style="width: {{ width }}%">
                {{ side.upper }} {{ average|floatformat:2 }}
              </div>
            {% endif %}
          {% endfor %}
        </div>
        <h6 class="mt-2 text-center text-muted">
          {% blocktrans trimmed count ndebates=motion.ndebates %}
            average points per position from {{ ndebates }} debate
          {% plural %}
            average points per position from {{ ndebates }} debates
          {% endblocktrans %}
        </h6>
      </div>
    </div>
  {% endif %}

  <div class="row">

    {% for side, counts_dict in motion.counts_by_side %}

      <div class="col-md-3 mb-3">
        <div class="progress">

          {% for points, count, percentage in counts_dict %}

            {% blocktrans trimmed with side=side.upper percentage=percentage|floatformat ndebates=motion.ndebates asvar tooltip_text %}
              {{ count }} of {{ ndebates }} results for {{ side }} ({{ percentage }}%) were for {{ points }} points
            {% endblocktrans %}

            <div class="progress-bar progress-points-{{ points }}"
                 style="width: {{ percentage }}%" data-toggle="tooltip"
                 title="{{ tooltip_text }}">
              {% if count > 0 %}
                {% if round.stage == round.STAGE_ELIMINATION %}
                  {% if points == 3 %}
                    {% trans "top ½" %}
                  {% else %}
                    {% trans "bottom ½" %}
                  {% endif %}
                {% else %}
                  {% if points == 3 %}
                    {% if percentage >= 10 %}{% trans "1st" %}{% else %}{% trans "1" context "used when there isn't enough space to display '1st'" %}{% endif %}
                  {% elif points == 2 %}
                    {% if percentage >= 10 %}{% trans "2nd" %}{% else %}{% trans "2" context "used when there isn't enough space to display '2nd'" %}{% endif %}
                  {% elif points == 1 %}
                    {% if percentage >= 10 %}{% trans "3rd" %}{% else %}{% trans "3" context "used when there isn't enough space to display '3rd'" %}{% endif %}
                  {% else %}
                    {% if percentage >= 10 %}{% trans "4th" %}{% else %}{% trans "4" context "used when there isn't enough space to display '4th'" %}{% endif %}
                  {% endif %}
                {% endif %}
              {% endif %}
            </div>

          {% endfor %}

        </div>
        <h6 class="mt-2 text-center text-{{ side }}">
          {% blocktrans trimmed with side=side.upper %}
            {{ side }} results distribution
          {% endblocktrans %}
        </h6>
      </div>

    {% endfor %}

  </div>

{% else %}

  <div class="btn-group btn-group-xs pull-left mb-3">
    <div class="btn btn-primary" disabled="disabled">
      {% trans "No results for this topic" %}
    </div>
  </div>

{% endif %}

</div>
