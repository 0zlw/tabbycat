{% extends "base.html" %}
{% load debate_tags %}

{% block extra-head %}
{{ block.super }}
{% include "enter_results_head.html" %}
{% if debate.result_status == debate.STATUS_DRAFT %}
<script>
    $(document).ready(function() {

        function preSubmit() {
            $('#resultsForm input').removeAttr('readonly');
            $('#resultsForm select').removeAttr('disabled');
        }

        $('#resultsForm input[type="text"]').attr('readonly', 'true');
        $('#resultsForm select').attr('disabled', 'true');

        $('#incorrect').click(function() {
            $('#id_result_status').val('{{ debate.STATUS_NONE }}');
            preSubmit();
            $('#resultsForm').submit();
            return false;
        });

        $('#correct').click(function() {
            preSubmit();
        });
    });

</script>
{% endif %}
{% endblock %}

{% block head-title %}
{% if debate.result_status == debate.STATUS_DRAFT %}
Confirm Results for {{ debate.matchup }}
{% else %}
Enter Results for {{ debate.matchup }}
{% endif %}
{% endblock %}
{% block body-class %}monkey-enter-result{% endblock %}
{% block nav %}{% include "monkey/nav.html" %}{% endblock %}

{% block content %}

<h2>{{ debate.matchup }} (Round {{ debate.round }}, {{ debate.venue.name }})</h2>
<form id="resultsForm" action="." method="POST">
    {% include "enter_results_content.html" %}
    <div>
        {% if debate.result_status == debate.STATUS_NONE or debate.result_status == debate.STATUS_BALLOT_IN %}
        <input id="id_result_status" type="hidden" name="result_status" value="{{ debate.STATUS_DRAFT }}" />
        <input class="save" type="submit" value="Save results" tabindex="100" />
        {% endif %}
        {% if debate.result_status == debate.STATUS_DRAFT %}
        <input id="incorrect" type="button" value="Results incorrect" />
        <input id="id_result_status" type="hidden" name="result_status" value="{{ debate.STATUS_CONFIRMED }}" />
        <input id="correct" class="save" type="submit" value="Confirm results" />

        {% endif %}
    </div>
</form>

{% endblock content %}

