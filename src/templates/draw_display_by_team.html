{% extends "base.html" %}
{% load debate_tags %}

{% block extra-head %}
<script type="text/javascript">
    $(document).ready( function() {

        var table = $('#draw').dataTable({
            'bPaginate': false,
            "aaSorting": [[ 0, "asc" ]],
            "aoColumns": [
                  { "sType": "string" },
                  { "sType": "string" },
                  { "sType": "string" },
                  { "sType": "string" },
                  { "sType": "string" },
                  { "sType": "string" },
                  { "sType": "string" }
                ],
        });
        new $.fn.dataTable.FixedHeader( table );

        var emoji_arr = [];
        $.getJSON('/emoji/all.json', function(data) {
            for (var i in data) {
                //console.log(data[i]);
                emoji_arr.push(data[i]);
            }
            $(".team-emoji").each(function(index) {
                var emojiID = $(this).attr("class").replace('team-emoji team-', '');
                $(this).append('<img src="' + emoji_arr[parseInt(emojiID)] + '" />');
            });
         });
    });
</script>
{% endblock extra-head %}

{% block body-class %}draw-public-display{% endblock %}

{% block head-title %}Round {{ round }} Draw for {{ tournament }}{% endblock %}
{% block page-title %}Round {{ round }} Draw for {{ tournament }}{% endblock %}

{% block content %}

<table id="draw" class="table table-hover table-bordered table-striped">
    <thead>
        <tr>
            <th>Team</th>
            <th><span class="glyphicon glyphicon-map-marker" data-toggle="tooltip" title="Venue"></span></th>
            <th>e</th>
            <th>Affirmative</th>
            <th>e</th>
            <th>Negative</th>
            <th>Adjudicators</th>
        </tr>
    </thead>
    <tbody>
    {% for debate in draw %}
        <tr class="{{ debate.all_conflicts|yesno:'conflict,' }}">
            <td>{{ debate.aff_team.name }}</td>
            <td class="venue-name">
                {{ debate.venue_splitname }}
            </td>
            <td class="team-emoji team-{{ debate.aff_team.id }}" id=""></td>
            <td class="team-name" id="">
                <span title="{{ debate.aff_team.speakers|join:', ' }}" data-toggle="tooltip">{{ debate.aff_team.name }}</span>
            </td>
            <td class="team-emoji team-{{ debate.neg_team.id }}" id=""></td>
            <td class="team-name">
                <span title="{{ debate.neg_team.speakers|join:', ' }}" data-toggle="tooltip">{{ debate.neg_team.name }}</span>
            </td>
            <td class="adj-names">
                <ul class="">
                {% for item in debate.adjudicator_names_list %}
                    {% if "Ⓒ" in item %}
                        <li class=""><span class="adj-chair">{{ item }}</span>,</li>
                    {% elif "Ⓣ" in item %}
                        <li class=""><span class="adj-trainee">{{ item }}</span>,</li>
                    {% else %}
                        <li class=""><span class="adj-normal">{{ item }}</span>,</li>
                    {% endif %}

                {% endfor %}
                </ul>
            </td>
    {% endfor %}
    {% for debate in draw %}
        <tr class="{{ debate.all_conflicts|yesno:'conflict,' }}">
            <td>{{ debate.neg_team.name }}</td>
            <td class="venue-name">
                {{ debate.venue_splitname }}
            </td>
            <td class="team-emoji team-{{ debate.aff_team.id }}" id=""></td>
            <td class="team-name">
                <span title="{{ debate.aff_team.speakers|join:', ' }}" data-toggle="tooltip">{{ debate.aff_team.name }}</span>
            </td>
            <td class="team-emoji team-{{ debate.neg_team.id }}" id=""></td>
            <td class="team-name">
                <span title="{{ debate.neg_team.speakers|join:', ' }}" data-toggle="tooltip">{{ debate.neg_team.name }}</span>
            </td>
            <td class="adj-names">
                <ul class="">
                {% for item in debate.adjudicator_names_list %}

                    {% if "Ⓒ" in item %}
                        <li class=""><span class="adj-chair">{{ item }}</span>,</li>
                    {% elif "Ⓣ" in item %}
                        <li class=""><span class="adj-trainee">{{ item }}</span>,</li>
                    {% else %}
                        <li class=""><span class="adj-normal">{{ item }}</span>,</li>
                    {% endif %}

                {% endfor %}
                </ul>
            </td>
    {% endfor %}
    </tbody>
</table>

{% endblock content %}